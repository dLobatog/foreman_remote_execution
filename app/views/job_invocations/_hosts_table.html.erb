<%= form_tag job_invocation_path(@job_invocation), :method => "get",:id =>"search-form" do %>
  <div class="row">
    <div class="title_filter col-md-6">
      <div class="input-group">
        <%= auto_complete_search(:search,
                                 params[:search].try(:squeeze, " "),
                                 :placeholder => _("Filter") + ' ...',
                                 :path => hosts_path) %>
        <span class="input-group-btn">
          <button class="btn btn-default" type="submit">
            <%= icon_text("search",
                          content_tag(:span, _("Search"),
                                      :class => "hidden-xs")) %>
          </button>
        </span>
      </div>
    </div>
  </div>
<% end %>
<br>

<table id='hosts' class="table table-bordered table-striped table-condensed"
  data-refresh_required="<%= @job_invocation.resolved? ? '' : 'true' %>">
  <thead>
    <tr>
      <th><%= sort :name, :as => _('Host') %></th>
      <th><%= _('Status') %></th>
      <th><%= _('Actions') %></th>
    </tr>
  </thead>

  <div id='job_invocations_hosts_table'>
  </div>

  <tbody>
  <% @hosts.each do |host| %>
    <% template_invocation = @job_invocation.template_invocations.find { |template_invocation| template_invocation.host_id == host.id } %>
    <% task = template_invocation.try(:run_host_job_task) %>
    <tr>
      <% options = { :host => host, :task => task, :job_invocation => @job_invocation, :template_invocation => template_invocation } %>
      <%= render 'host_name_td', options %>
      <%= render 'host_status_td', options %>
      <%= render 'host_actions_td', options %>
    </tr>
  <% end %>
  </tbody>
</table>

<%= will_paginate_with_info @hosts %>
